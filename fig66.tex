
% --- Fig.66: ECDF sin|b| + inset dipole/quadrupole ---
\begin{figure}[t]
\centering
\begin{minipage}{0.68\linewidth}
\begin{tikzpicture}
\begin{axis}[
  width=\linewidth, height=5cm,
  xlabel={$\sin|b|$}, ylabel={ECDF},
  xmin=0, xmax=1, ymin=0, ymax=1,
  ticklabel style={font=\footnotesize},
  label style={font=\footnotesize},
  legend style={draw=none, fill=none, font=\footnotesize, at={(0.02,0.98)}, anchor=north west},
  clip=false,
]
% null band (95%) from selection-preserving null
\addplot [name path=upper, draw=none] coordinates [(np.float64(0.0), np.float64(0.0)), (np.float64(0.016666666666666666), np.float64(0.0)), (np.float64(0.03333333333333333), np.float64(0.0)), (np.float64(0.05), np.float64(0.0)), (np.float64(0.06666666666666667), np.float64(0.0)), (np.float64(0.08333333333333333), np.float64(0.0)), (np.float64(0.1), np.float64(0.0)), (np.float64(0.11666666666666667), np.float64(0.0)), (np.float64(0.13333333333333333), np.float64(0.0)), (np.float64(0.15), np.float64(0.9523252945875396)), (np.float64(0.16666666666666666), np.float64(1.0)), (np.float64(0.18333333333333332), np.float64(1.0)), (np.float64(0.2), np.float64(1.0)), (np.float64(0.21666666666666667), np.float64(1.0)), (np.float64(0.23333333333333334), np.float64(1.0)), (np.float64(0.25), np.float64(1.0)), (np.float64(0.26666666666666666), np.float64(1.0)), (np.float64(0.2833333333333333), np.float64(1.0)), (np.float64(0.3), np.float64(1.0)), (np.float64(0.31666666666666665), np.float64(1.0)), (np.float64(0.3333333333333333), np.float64(1.0)), (np.float64(0.35), np.float64(1.0)), (np.float64(0.36666666666666664), np.float64(1.0)), (np.float64(0.3833333333333333), np.float64(1.0)), (np.float64(0.4), np.float64(1.0)), (np.float64(0.4166666666666667), np.float64(1.0)), (np.float64(0.43333333333333335), np.float64(1.0)), (np.float64(0.45), np.float64(1.0)), (np.float64(0.4666666666666667), np.float64(1.0)), (np.float64(0.48333333333333334), np.float64(1.0)), (np.float64(0.5), np.float64(1.0)), (np.float64(0.5166666666666666), np.float64(1.0)), (np.float64(0.5333333333333333), np.float64(1.0)), (np.float64(0.55), np.float64(1.0)), (np.float64(0.5666666666666667), np.float64(1.0)), (np.float64(0.5833333333333334), np.float64(1.0)), (np.float64(0.6), np.float64(1.0)), (np.float64(0.6166666666666667), np.float64(1.0)), (np.float64(0.6333333333333333), np.float64(1.0)), (np.float64(0.65), np.float64(1.0)), (np.float64(0.6666666666666666), np.float64(1.0)), (np.float64(0.6833333333333333), np.float64(1.0)), (np.float64(0.7), np.float64(1.0)), (np.float64(0.7166666666666667), np.float64(1.0)), (np.float64(0.7333333333333333), np.float64(1.0)), (np.float64(0.75), np.float64(1.0)), (np.float64(0.7666666666666666), np.float64(1.0)), (np.float64(0.7833333333333333), np.float64(1.0)), (np.float64(0.8), np.float64(1.0)), (np.float64(0.8166666666666667), np.float64(1.0)), (np.float64(0.8333333333333334), np.float64(1.0)), (np.float64(0.85), np.float64(1.0)), (np.float64(0.8666666666666667), np.float64(1.0)), (np.float64(0.8833333333333333), np.float64(1.0)), (np.float64(0.9), np.float64(1.0)), (np.float64(0.9166666666666666), np.float64(1.0)), (np.float64(0.9333333333333333), np.float64(1.0)), (np.float64(0.95), np.float64(1.0)), (np.float64(0.9666666666666667), np.float64(1.0)), (np.float64(0.9833333333333333), np.float64(1.0)), (np.float64(1.0), np.float64(1.0))];
\addplot [name path=lower, draw=none] coordinates [(np.float64(0.0), np.float64(0.0)), (np.float64(0.016666666666666666), np.float64(0.0)), (np.float64(0.03333333333333333), np.float64(0.0)), (np.float64(0.05), np.float64(0.0)), (np.float64(0.06666666666666667), np.float64(0.0)), (np.float64(0.08333333333333333), np.float64(0.0)), (np.float64(0.1), np.float64(0.0)), (np.float64(0.11666666666666667), np.float64(0.0)), (np.float64(0.13333333333333333), np.float64(0.0)), (np.float64(0.15), np.float64(0.2856586279208729)), (np.float64(0.16666666666666666), np.float64(1.0)), (np.float64(0.18333333333333332), np.float64(1.0)), (np.float64(0.2), np.float64(1.0)), (np.float64(0.21666666666666667), np.float64(1.0)), (np.float64(0.23333333333333334), np.float64(1.0)), (np.float64(0.25), np.float64(1.0)), (np.float64(0.26666666666666666), np.float64(1.0)), (np.float64(0.2833333333333333), np.float64(1.0)), (np.float64(0.3), np.float64(1.0)), (np.float64(0.31666666666666665), np.float64(1.0)), (np.float64(0.3333333333333333), np.float64(1.0)), (np.float64(0.35), np.float64(1.0)), (np.float64(0.36666666666666664), np.float64(1.0)), (np.float64(0.3833333333333333), np.float64(1.0)), (np.float64(0.4), np.float64(1.0)), (np.float64(0.4166666666666667), np.float64(1.0)), (np.float64(0.43333333333333335), np.float64(1.0)), (np.float64(0.45), np.float64(1.0)), (np.float64(0.4666666666666667), np.float64(1.0)), (np.float64(0.48333333333333334), np.float64(1.0)), (np.float64(0.5), np.float64(1.0)), (np.float64(0.5166666666666666), np.float64(1.0)), (np.float64(0.5333333333333333), np.float64(1.0)), (np.float64(0.55), np.float64(1.0)), (np.float64(0.5666666666666667), np.float64(1.0)), (np.float64(0.5833333333333334), np.float64(1.0)), (np.float64(0.6), np.float64(1.0)), (np.float64(0.6166666666666667), np.float64(1.0)), (np.float64(0.6333333333333333), np.float64(1.0)), (np.float64(0.65), np.float64(1.0)), (np.float64(0.6666666666666666), np.float64(1.0)), (np.float64(0.6833333333333333), np.float64(1.0)), (np.float64(0.7), np.float64(1.0)), (np.float64(0.7166666666666667), np.float64(1.0)), (np.float64(0.7333333333333333), np.float64(1.0)), (np.float64(0.75), np.float64(1.0)), (np.float64(0.7666666666666666), np.float64(1.0)), (np.float64(0.7833333333333333), np.float64(1.0)), (np.float64(0.8), np.float64(1.0)), (np.float64(0.8166666666666667), np.float64(1.0)), (np.float64(0.8333333333333334), np.float64(1.0)), (np.float64(0.85), np.float64(1.0)), (np.float64(0.8666666666666667), np.float64(1.0)), (np.float64(0.8833333333333333), np.float64(1.0)), (np.float64(0.9), np.float64(1.0)), (np.float64(0.9166666666666666), np.float64(1.0)), (np.float64(0.9333333333333333), np.float64(1.0)), (np.float64(0.95), np.float64(1.0)), (np.float64(0.9666666666666667), np.float64(1.0)), (np.float64(0.9833333333333333), np.float64(1.0)), (np.float64(1.0), np.float64(1.0))];
\addplot [fill=black!12, draw=none] fill between[of=upper and lower];
% median null
\addplot [densely dashed] coordinates [(np.float64(0.0), np.float64(0.0)), (np.float64(0.016666666666666666), np.float64(0.0)), (np.float64(0.03333333333333333), np.float64(0.0)), (np.float64(0.05), np.float64(0.0)), (np.float64(0.06666666666666667), np.float64(0.0)), (np.float64(0.08333333333333333), np.float64(0.0)), (np.float64(0.1), np.float64(0.0)), (np.float64(0.11666666666666667), np.float64(0.0)), (np.float64(0.13333333333333333), np.float64(0.0)), (np.float64(0.15), np.float64(0.6189919612542062)), (np.float64(0.16666666666666666), np.float64(1.0)), (np.float64(0.18333333333333332), np.float64(1.0)), (np.float64(0.2), np.float64(1.0)), (np.float64(0.21666666666666667), np.float64(1.0)), (np.float64(0.23333333333333334), np.float64(1.0)), (np.float64(0.25), np.float64(1.0)), (np.float64(0.26666666666666666), np.float64(1.0)), (np.float64(0.2833333333333333), np.float64(1.0)), (np.float64(0.3), np.float64(1.0)), (np.float64(0.31666666666666665), np.float64(1.0)), (np.float64(0.3333333333333333), np.float64(1.0)), (np.float64(0.35), np.float64(1.0)), (np.float64(0.36666666666666664), np.float64(1.0)), (np.float64(0.3833333333333333), np.float64(1.0)), (np.float64(0.4), np.float64(1.0)), (np.float64(0.4166666666666667), np.float64(1.0)), (np.float64(0.43333333333333335), np.float64(1.0)), (np.float64(0.45), np.float64(1.0)), (np.float64(0.4666666666666667), np.float64(1.0)), (np.float64(0.48333333333333334), np.float64(1.0)), (np.float64(0.5), np.float64(1.0)), (np.float64(0.5166666666666666), np.float64(1.0)), (np.float64(0.5333333333333333), np.float64(1.0)), (np.float64(0.55), np.float64(1.0)), (np.float64(0.5666666666666667), np.float64(1.0)), (np.float64(0.5833333333333334), np.float64(1.0)), (np.float64(0.6), np.float64(1.0)), (np.float64(0.6166666666666667), np.float64(1.0)), (np.float64(0.6333333333333333), np.float64(1.0)), (np.float64(0.65), np.float64(1.0)), (np.float64(0.6666666666666666), np.float64(1.0)), (np.float64(0.6833333333333333), np.float64(1.0)), (np.float64(0.7), np.float64(1.0)), (np.float64(0.7166666666666667), np.float64(1.0)), (np.float64(0.7333333333333333), np.float64(1.0)), (np.float64(0.75), np.float64(1.0)), (np.float64(0.7666666666666666), np.float64(1.0)), (np.float64(0.7833333333333333), np.float64(1.0)), (np.float64(0.8), np.float64(1.0)), (np.float64(0.8166666666666667), np.float64(1.0)), (np.float64(0.8333333333333334), np.float64(1.0)), (np.float64(0.85), np.float64(1.0)), (np.float64(0.8666666666666667), np.float64(1.0)), (np.float64(0.8833333333333333), np.float64(1.0)), (np.float64(0.9), np.float64(1.0)), (np.float64(0.9166666666666666), np.float64(1.0)), (np.float64(0.9333333333333333), np.float64(1.0)), (np.float64(0.95), np.float64(1.0)), (np.float64(0.9666666666666667), np.float64(1.0)), (np.float64(0.9833333333333333), np.float64(1.0)), (np.float64(1.0), np.float64(1.0))];
% data ECDF
\addplot [very thick] coordinates [(np.float64(0.0), np.float64(0.0)), (np.float64(0.016666666666666666), np.float64(0.0)), (np.float64(0.03333333333333333), np.float64(0.0)), (np.float64(0.05), np.float64(0.0)), (np.float64(0.06666666666666667), np.float64(0.0)), (np.float64(0.08333333333333333), np.float64(0.0)), (np.float64(0.1), np.float64(0.0)), (np.float64(0.11666666666666667), np.float64(0.0)), (np.float64(0.13333333333333333), np.float64(0.0)), (np.float64(0.15), np.float64(0.8765901030629013)), (np.float64(0.16666666666666666), np.float64(1.0)), (np.float64(0.18333333333333332), np.float64(1.0)), (np.float64(0.2), np.float64(1.0)), (np.float64(0.21666666666666667), np.float64(1.0)), (np.float64(0.23333333333333334), np.float64(1.0)), (np.float64(0.25), np.float64(1.0)), (np.float64(0.26666666666666666), np.float64(1.0)), (np.float64(0.2833333333333333), np.float64(1.0)), (np.float64(0.3), np.float64(1.0)), (np.float64(0.31666666666666665), np.float64(1.0)), (np.float64(0.3333333333333333), np.float64(1.0)), (np.float64(0.35), np.float64(1.0)), (np.float64(0.36666666666666664), np.float64(1.0)), (np.float64(0.3833333333333333), np.float64(1.0)), (np.float64(0.4), np.float64(1.0)), (np.float64(0.4166666666666667), np.float64(1.0)), (np.float64(0.43333333333333335), np.float64(1.0)), (np.float64(0.45), np.float64(1.0)), (np.float64(0.4666666666666667), np.float64(1.0)), (np.float64(0.48333333333333334), np.float64(1.0)), (np.float64(0.5), np.float64(1.0)), (np.float64(0.5166666666666666), np.float64(1.0)), (np.float64(0.5333333333333333), np.float64(1.0)), (np.float64(0.55), np.float64(1.0)), (np.float64(0.5666666666666667), np.float64(1.0)), (np.float64(0.5833333333333334), np.float64(1.0)), (np.float64(0.6), np.float64(1.0)), (np.float64(0.6166666666666667), np.float64(1.0)), (np.float64(0.6333333333333333), np.float64(1.0)), (np.float64(0.65), np.float64(1.0)), (np.float64(0.6666666666666666), np.float64(1.0)), (np.float64(0.6833333333333333), np.float64(1.0)), (np.float64(0.7), np.float64(1.0)), (np.float64(0.7166666666666667), np.float64(1.0)), (np.float64(0.7333333333333333), np.float64(1.0)), (np.float64(0.75), np.float64(1.0)), (np.float64(0.7666666666666666), np.float64(1.0)), (np.float64(0.7833333333333333), np.float64(1.0)), (np.float64(0.8), np.float64(1.0)), (np.float64(0.8166666666666667), np.float64(1.0)), (np.float64(0.8333333333333334), np.float64(1.0)), (np.float64(0.85), np.float64(1.0)), (np.float64(0.8666666666666667), np.float64(1.0)), (np.float64(0.8833333333333333), np.float64(1.0)), (np.float64(0.9), np.float64(1.0)), (np.float64(0.9166666666666666), np.float64(1.0)), (np.float64(0.9333333333333333), np.float64(1.0)), (np.float64(0.95), np.float64(1.0)), (np.float64(0.9666666666666667), np.float64(1.0)), (np.float64(0.9833333333333333), np.float64(1.0)), (np.float64(1.0), np.float64(1.0))];
\addlegendentry{Data}
\addlegendentry{Null band (95\%)}
\end{axis}
\end{tikzpicture}
\end{minipage}\hfill
\begin{minipage}{0.28\linewidth}
\begin{tikzpicture}
\begin{axis}[
  width=\linewidth, height=5cm,
  ybar, bar width=7pt,
  xmin=0.5, xmax=2.5, ymin=0, ymax={max(0.08, 0.523*1.6):.2f},
  xtick={1,2}, xticklabels={Dipole,Quadrupole},
  ylabel={Amplitude}, ticklabel style={font=\footnotesize},
  label style={font=\footnotesize}
]
\addplot[fill=black!40] coordinates {(1,0.000) (2,0.523)};
\end{axis}
\end{tikzpicture}
\end{minipage}
\caption{ECDF of $\sin|b|$ for min-basin centroids (data) versus the selection-preserving null (median and 95\% envelope). Inset: flat-sky moment amplitudes (dipole, quadrupole).}
\label{fig:gp_ecdf_dipquad}
\end{figure}
